<!DOCTYPE html>
<html>
<head>
  <title>ASN.1 JavaScript decoder</title>
  <link rel="stylesheet" href="main.css" type="text/css">
  <script type="text/javascript" src="hex.js"></script>
  <script type="text/javascript" src="base64.js"></script>
  <script type="text/javascript" src="oids.js"></script>
  <script type="text/javascript" src="asn1.js"></script>
  <script type="text/javascript">
    var reHex = /^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/;
    function decode() {
      document.getElementById('help').style.display = 'none';
      var tree = document.getElementById('tree');
      var dump = document.getElementById('dump');
      tree.innerHTML = "";
      dump.innerHTML = "";
      try {
        var pem = document.getElementById('pem').value;
        var der = reHex.test(pem)
	    ? Hex.decode(pem)
	    : Base64.unarmor(pem);
        var asn1 = ASN1.decode(der);
        tree.appendChild(asn1.toDOM());
        dump.appendChild(asn1.toHexDOM());
      } catch (e) {
        tree.innerHTML = e;
      }
      return false;
    }
    function help() {
      document.getElementById('tree').innerHTML = "";
      document.getElementById('dump').innerHTML = "";
      document.getElementById('help').style.display = 'block';
    }
  </script>
</head>
<body>
<h1>ASN.1 JavaScript decoder</h1>
<form>
  <textarea id="pem" style="width: 100%;" rows="8">MCcCAQEwHzAHBgUrDgMCGgQUnhEBKvg8fTVa5r0bftJbqOES7LYBAf8=</textarea><br/>
  <input type="button" value="decode" onclick="decode();">
  <input type="button" value="help" onclick="help();">
</form>
<div id="help">
  <h2>Instructions</h2>
  <p>This page contains a JavaScript generic ASN.1 parser that can decode any valid ASN.1 DER or BER structure whether Base64-encoded (raw base64, PEM armoring and <tt>begin-base64</tt> are recognized) or Hex-encoded. </p>
  <p>This tool can be used online at the address <a href="http://lapo.it/asn1js/"><tt>http://lapo.it/asn1js/</tt></a> or offline, unpacking <a href="http://lapo.it/asn1js/asn1js.zip">the ZIP file</a> in a directory and opening <tt>index.html</tt> in a browser</p>
  <p>On the left of the page will be printed a tree representing the hierarchical structure, on the right side an hex dump will be shown. <br/>
  Hovering on the tree highlights ancestry (the hovered node and all its ancestors get colored) and the position of the hovered node gets highlighted in the hex dump (with header and content in a different colors). <br/>
  Clicking a node in the tree will hide its sub-nodes (collapsed nodes can be noticed because they will become <i>italic</i>).</p>
  <h3>Copyright</h3>
  <p>ASN.1 JavaScript decoder Copyright &copy; 2008-2009 <a href="htp://lapo.it/">Lapo Luchini</a>; released as <a href="http://opensource.org/licenses/isc-license.txt">opensource</a> under the <a href="http://en.wikipedia.org/wiki/ISC_licence">ISC license</a>.</p>
  <p><tt>OBJECT&nbsp;IDENTIFIER</tt> values are recognized using data taken from Peter Gutmann's <a href="http://www.cs.auckland.ac.nz/~pgut001/#standards">dumpasn1</a> program.</p>
</div>
<div style="position: relative; padding-top: 1em;">
  <div id="tree"></div>
  <div id="dump" style="position: absolute; top: 0px; right: 0px;"></div>
</div>
</body>
</html>
